<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="paperjs-v0.9.25/dist/paper-full.js"></script>
<script type="text/paperscript" canvas="Canvas">

	var path = new Path();
	path.strokeColor = 'grey';
	path.selected = true;

  var SIZE = 16;
  var x = 600;
	var y = 300;

  var start = new Point(x, y);
  path.add(start);

	var myCircle = new Path.Circle(new Point(x, y), 5);
	myCircle.fillColor = 'grey'; 

  // ---------------------
  //var sequence = [615, 614, 612, 614, 615, 512, 514, 515, 514, 512, 517, 515, 514, 515, 517, 414, 416, 417, 416, 414];
	//var sequence = [612, 613, 614, 615, 512, 513, 514, 515];
	//var sequence = [612, 511, 410, 309, 208, 107];
	var sequence = [508, 510, 511, 510, 508, 507, 508, 510, 508, 507, 508, 510, 511, 408, 409, 411, 409, 408, 409, 411, 412, 411, 409, 408, 409, 411, 409, 408, 511, 510];

  // INIT
	var n = 1;
	var p = 0;
	for (i = 0; i < sequence.length - 1; i++, n++, p++) 
	{
		var Pz = parseSeq(sequence[p]);
		var Nz = parseSeq(sequence[n]);
		seqDecompose(Pz, Nz);
	}

  function parseSeq (sequence)
	{
		var x = sequence.toString();
		var root = x.charAt(0).toString();
		var two = x.substr(1, 2).toString();
		var z = two.charAt(0).toString();
		var subroot = "";

		if (parseInt(z) == 0) {
			subroot = two.charAt(1);
		}
		else {
			subroot = two;
		}

		var ret = [root, subroot];

		return ret;
	}


/*
	function onFrame (event) 
	{
    seqWalk();
		
		if (n > seq.length - 1)
		{
		  event.stop();
		}
	}
	*/

  function seqWalk (X)
	{
		// left
		if (X < 0)
		{
			x = x - (SIZE * (X * -1) );
			var myCircle = new Path.Circle(new Point(x, y), 5);
			myCircle.fillColor = 'red'; 
		}

		// right
		else if ( X > 0)
		{
			x = x + (SIZE * X);
			var myCircle = new Path.Circle(new Point(x, y), 5);
			myCircle.fillColor = 'green'; 
		}

		// stick
		else if (X == 0) 
		{ 

		}

		// draw Line
		var next = new Point(x, y);
		path.add(next);
	}

  function drawSeq (X, Y, ps, pn, ns, nn)
	{

		// X - interval right-left (+right) (-left)
		// Y - interval up-down    (+up)    (-down)  

		// on the same string
		if (Y == 0) 
		{
			console.log(Y + " same " + X + " " + ps, pn, ns, nn + " [" + x + "," + y + "]");

			seqWalk(X);
		}

		// up
		else if (Y > 0) 
		{
			console.log(Y + " up " + X + " " + ps, pn, ns, nn + " [" + x + "," + y + "]");

			y = y - (SIZE * (Y * -1) );
			// draw Line
			var next = new Point(x, y);
			path.add(next);

			seqWalk(X);
		}

		// down
		else if (Y < 0)
		{
			console.log(Y + " down " + X + " " + ps, pn, ns, nn + " [" + x + "," + y + "]");

			y = y + (SIZE * Y);
			// draw Line
			var next = new Point(x, y);
			path.add(next);

			seqWalk(X);
		}

		// EOF
	}

  function seqDecompose (Pz, Nz)
	{
		var ps = Pz[0];
		var pn = Pz[1];
		var ns = Nz[0];
		var nn = Nz[1];
    var X = nn - pn;
		var Y = ns - ps;
		drawSeq (X, Y, ps, pn, ns, nn)
	}

</script>

</head>
	<body>
		<canvas id="Canvas"  width="1200" height="600" style="border:1px solid #333333;"></canvas>
	</body>
</html>
